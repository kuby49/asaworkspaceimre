{
	"name": "Lab 1  - explore sales data",
	"properties": {
		"content": {
			"query": "SELECT\n    r.filepath(1) as [year], r.filepath(2) as [quarter], count(*)\nFROM\n    OPENROWSET(\n        BULK 'https://asadatalakeimre.dfs.core.windows.net/wwi-02/sale-small/Year=*/Quarter=*/Month=*/Day=*/*snappy.parquet',\n        FORMAT='PARQUET'\n    )\n AS [r]\n where r.filepath(1)  IN (2012, 2013)\n group by r.filepath(1), r.filepath(2)\n\n SELECT\n    TOP 100 r.filepath(1) as [Year]\nFROM\n    OPENROWSET(\n        BULK 'https://asadatalakeimre.dfs.core.windows.net/wwi-02/sale-small/Year=*/Quarter=Q4/Month=12/Day=20161231/sale-small-20161231-snappy.parquet',\n        FORMAT='PARQUET'\n    )\n AS [r]\n\nSELECT\n    r.filepath(2) as [filepath], count(*)\nFROM\n    OPENROWSET(\n        BULK 'https://asadatalakeimre.dfs.core.windows.net/wwi-02/sale-small/Year=2016/Quarter=Q4/Month=12/Day=20161231/sale-small-20161231-snappy.parquet',\n        FORMAT='PARQUET'\n    )\n AS [r]\n GROUP BY  r.filepath(2)\n\nSELECT\n        TransactionDate, ProductId,\n        CAST(SUM(ProfitAmount) AS decimal(18,2)) AS [(sum) Profit],\n        CAST(AVG(ProfitAmount) AS decimal(18,2)) AS [(avg) Profit],\n        SUM(Quantity) AS [(sum) Quantity]\nFROM\n    OPENROWSET(\n        BULK 'https://asadatalakeimre.dfs.core.windows.net/wwi-02/sale-small/Year=2016/Quarter=Q4/Month=12/Day=20161231/sale-small-20161231-snappy.parquet',\n        FORMAT='PARQUET'\n    ) AS [r] GROUP BY r.filepath(1), r.TransactionDate, r.ProductId;\n\n\nSELECT\n    COUNT(*)\nFROM\n    OPENROWSET(\n        BULK 'https://asadatalakeimre.dfs.core.windows.net/wwi-02/sale-small/Year=2019/*/*/*/*',\n        FORMAT='PARQUET'\n    ) AS [r];\n\nSELECT\n    COUNT(*)\nFROM\n    OPENROWSET(\n        BULK 'https://asadatalakeimre.dfs.core.windows.net/wwi-02/sale-small/ZTSI_ACTR.LF.TMP_BILKODE_LKV_POLICA.csv',\n        FORMAT='CSV'\n        ,FIELDTERMINATOR = ';'    \n        ,ROWTERMINATOR = '0x0a' \n --       ,ESCAPE_CHAR = '\\\\'\n        ,FIRSTROW = 1     \n        ,FIELDQUOTE = '\"'\n --       ,DATA_COMPRESSION = 'org.apache.hadoop.io.compress.GzipCodec'\n        ,PARSER_VERSION = '2.0'\n        ,HEADER_ROW = FALSE\n\n    ) AS [r];\n\nSELECT\n    COUNT(*)\nFROM\n    OPENROWSET(\n        BULK 'https://asadatalakeimre.dfs.core.windows.net/wwi-02/sale-small/ZTSI_ACTR.LF.TMP_BILKODE_LKV_POLICA.csv.gz',\n        FORMAT='CSV'\n        ,FIELDTERMINATOR = ';'    \n        ,ROWTERMINATOR = '0x0a' \n        ,ESCAPECHAR = '\\\\'\n        ,FIRSTROW = 1     \n        ,DATA_COMPRESSION = 'GZIP'\n        ,PARSER_VERSION = '1.0'\n        ,HEADER_ROW = FALSE\n        ,DATAFILETYPE ='char'\n    )\n        WITH \n    (\n\"ROW_NO_POK\" BIGINT,\n\"ROW_NO\" BIGINT,\n\"ID_POLICA\" INTEGER,\n\"ID_RIZIK\" FLOAT,\n\"UREDI\" VARCHAR(1),\n\"STEV\" BIGINT,\n\"TIP_ENOTE\" NVARCHAR(32),\n\"UL_SKLADI_PLUS\" NVARCHAR(32),\n\"LKV_RENTA_OSN\" DECIMAL(18,2),\n\"LKV_RENTA_KAPIT\" DECIMAL(18,2),\n\"LKV_RENTA_BONIF\" DECIMAL(18,2),\n\"LKV_RENTA_PRES\" FLOAT,\n\"CENIK_RIZIKA\" NVARCHAR(40),\n\"DAT_ZAC_IZPL_REN\" DATETIME,\n\"LKV_PREDUJEM_SKUP\" FLOAT,\n\"TP_OBR_MERA_IZPL\" DECIMAL(6,4),\n\"TP_TAB_IZPL\" NVARCHAR(40),\n\"GAMA_IZPL\" DECIMAL(6,4),\n\"STAR_ZAV_1\" DECIMAL(5,2),\n\"STAR_POST_1\" INTEGER,\n\"SPOL_ZAV_1\" INTEGER,\n\"UPR_TRAJ_IZPL\" SMALLINT,\n\"UPR_TRAJ_ZAJ_IZPL\" INTEGER,\n\"CEP_ZAV_POGOJI\" NVARCHAR(80),\n\"UPR_OSN_VREDN\" DECIMAL(18,2),\n\"UPR_KAPIT_VREDN\" DECIMAL(18,2),\n\"UPR_BONIF_VREDN\" DECIMAL(18,2),\n\"TP_OBR_MERA\" DECIMAL(6,4),\n\"TP_TAB_RIZIKO1\" NVARCHAR(40),\n\"TP_TAB_RIZIKO2\" NVARCHAR(40),\n\"BE_UNISEX_FLAG\" VARCHAR(1),\n\"TP_TAB_REZ_RIZ1\" NVARCHAR(40),\n\"TP_TAB_REZ_RIZ2\" NVARCHAR(40),\n\"ZOS_POV_STAR\" DECIMAL(5,2),\n\"ZOS_POV_STAR_POST\" DECIMAL(5,2),\n\"NADUMR_ZAV_1\" DECIMAL(5,4),\n\"FLAT_PREM_ZAV_1\" DECIMAL(4,4),\n\"DOBA_FLAT_ZAV_1\" DECIMAL(5,2),\n\"TP_ZDRAVJA_1\" INTEGER,\n\"STAR_ZAV_2\" DECIMAL(5,2),\n\"STAR_POST_2\" INTEGER,\n\"SPOL_ZAV_2\" INTEGER,\n\"NADUMR_ZAV_2\" DECIMAL(5,4),\n\"FLAT_PREM_ZAV_2\" DECIMAL(4,4),\n\"DOBA_FLAT_ZAV_2\" DECIMAL(5,2),\n\"TP_ZDRAVJA_2\" INTEGER,\n\"ID_PERSON_1\" INTEGER,\n\"ID_PERSON_2\" INTEGER,\n\"ZAV_POGOJI\" NVARCHAR(140) \n    ) AS [r]; \n\n\nSELECT\n    COUNT(*)\nFROM\n    OPENROWSET(\n        BULK 'https://asadatalakeimre.dfs.core.windows.net/wwi-02/sale-small/ZTSI_ACTR.LF.TMP_BILKODE_LKV_POLICA.csv',\n        FORMAT = 'CSV', PARSER_VERSION = '2.0',\n        FIELDTERMINATOR =';',\n        ROWTERMINATOR = '\\n',\n        ESCAPECHAR = '\\\\',\n        FIRSTROW = 1\n    ) \n    WITH \n    (\n\"ROW_NO_POK\" BIGINT,\n\"ROW_NO\" BIGINT,\n\"ID_POLICA\" INTEGER,\n\"ID_RIZIK\" FLOAT,\n\"UREDI\" VARCHAR(1),\n\"STEV\" BIGINT,\n\"TIP_ENOTE\" NVARCHAR(32),\n\"UL_SKLADI_PLUS\" NVARCHAR(32),\n\"LKV_RENTA_OSN\" DECIMAL(18,2),\n\"LKV_RENTA_KAPIT\" DECIMAL(18,2),\n\"LKV_RENTA_BONIF\" DECIMAL(18,2),\n\"LKV_RENTA_PRES\" FLOAT,\n\"CENIK_RIZIKA\" NVARCHAR(40),\n\"DAT_ZAC_IZPL_REN\" DATETIME,\n\"LKV_PREDUJEM_SKUP\" FLOAT,\n\"TP_OBR_MERA_IZPL\" DECIMAL(6,4),\n\"TP_TAB_IZPL\" NVARCHAR(40),\n\"GAMA_IZPL\" DECIMAL(6,4),\n\"STAR_ZAV_1\" DECIMAL(5,2),\n\"STAR_POST_1\" INTEGER,\n\"SPOL_ZAV_1\" INTEGER,\n\"UPR_TRAJ_IZPL\" SMALLINT,\n\"UPR_TRAJ_ZAJ_IZPL\" INTEGER,\n\"CEP_ZAV_POGOJI\" NVARCHAR(80),\n\"UPR_OSN_VREDN\" DECIMAL(18,2),\n\"UPR_KAPIT_VREDN\" DECIMAL(18,2),\n\"UPR_BONIF_VREDN\" DECIMAL(18,2),\n\"TP_OBR_MERA\" DECIMAL(6,4),\n\"TP_TAB_RIZIKO1\" NVARCHAR(40),\n\"TP_TAB_RIZIKO2\" NVARCHAR(40),\n\"BE_UNISEX_FLAG\" VARCHAR(1),\n\"TP_TAB_REZ_RIZ1\" NVARCHAR(40),\n\"TP_TAB_REZ_RIZ2\" NVARCHAR(40),\n\"ZOS_POV_STAR\" DECIMAL(5,2),\n\"ZOS_POV_STAR_POST\" DECIMAL(5,2),\n\"NADUMR_ZAV_1\" DECIMAL(5,4),\n\"FLAT_PREM_ZAV_1\" DECIMAL(4,4),\n\"DOBA_FLAT_ZAV_1\" DECIMAL(5,2),\n\"TP_ZDRAVJA_1\" INTEGER,\n\"STAR_ZAV_2\" DECIMAL(5,2),\n\"STAR_POST_2\" INTEGER,\n\"SPOL_ZAV_2\" INTEGER,\n\"NADUMR_ZAV_2\" DECIMAL(5,4),\n\"FLAT_PREM_ZAV_2\" DECIMAL(4,4),\n\"DOBA_FLAT_ZAV_2\" DECIMAL(5,2),\n\"TP_ZDRAVJA_2\" INTEGER,\n\"ID_PERSON_1\" INTEGER,\n\"ID_PERSON_2\" INTEGER,\n\"ZAV_POGOJI\" NVARCHAR(140) \n    ) AS [r];\n\n\nSELECT\n    COUNT(*)\nFROM\n    OPENROWSET(\n        BULK 'https://asadatalakeimre.dfs.core.windows.net/wwi-02/sale-small/ZTSI_ACTR.LF.TMP_BILKODE_LKV_POLICA.csv',\n        FORMAT = 'CSV', PARSER_VERSION = '1.0',\n        FIELDTERMINATOR =';',\n        ROWTERMINATOR = '\\n',\n        ESCAPECHAR = '\\\\',\n        FIRSTROW = 1\n    ) \n    WITH \n    (\n\"ROW_NO_POK\" BIGINT,\n\"ROW_NO\" BIGINT,\n\"ID_POLICA\" INTEGER,\n\"ID_RIZIK\" FLOAT,\n\"UREDI\" VARCHAR(1),\n\"STEV\" BIGINT,\n\"TIP_ENOTE\" NVARCHAR(32),\n\"UL_SKLADI_PLUS\" NVARCHAR(32),\n\"LKV_RENTA_OSN\" DECIMAL(18,2),\n\"LKV_RENTA_KAPIT\" DECIMAL(18,2),\n\"LKV_RENTA_BONIF\" DECIMAL(18,2),\n\"LKV_RENTA_PRES\" FLOAT,\n\"CENIK_RIZIKA\" NVARCHAR(40),\n\"DAT_ZAC_IZPL_REN\" DATETIME,\n\"LKV_PREDUJEM_SKUP\" FLOAT,\n\"TP_OBR_MERA_IZPL\" DECIMAL(6,4),\n\"TP_TAB_IZPL\" NVARCHAR(40),\n\"GAMA_IZPL\" DECIMAL(6,4),\n\"STAR_ZAV_1\" DECIMAL(5,2),\n\"STAR_POST_1\" INTEGER,\n\"SPOL_ZAV_1\" INTEGER,\n\"UPR_TRAJ_IZPL\" SMALLINT,\n\"UPR_TRAJ_ZAJ_IZPL\" INTEGER,\n\"CEP_ZAV_POGOJI\" NVARCHAR(80),\n\"UPR_OSN_VREDN\" DECIMAL(18,2),\n\"UPR_KAPIT_VREDN\" DECIMAL(18,2),\n\"UPR_BONIF_VREDN\" DECIMAL(18,2),\n\"TP_OBR_MERA\" DECIMAL(6,4),\n\"TP_TAB_RIZIKO1\" NVARCHAR(40),\n\"TP_TAB_RIZIKO2\" NVARCHAR(40),\n\"BE_UNISEX_FLAG\" VARCHAR(1),\n\"TP_TAB_REZ_RIZ1\" NVARCHAR(40),\n\"TP_TAB_REZ_RIZ2\" NVARCHAR(40),\n\"ZOS_POV_STAR\" DECIMAL(5,2),\n\"ZOS_POV_STAR_POST\" DECIMAL(5,2),\n\"NADUMR_ZAV_1\" DECIMAL(5,4),\n\"FLAT_PREM_ZAV_1\" DECIMAL(4,4),\n\"DOBA_FLAT_ZAV_1\" DECIMAL(5,2),\n\"TP_ZDRAVJA_1\" INTEGER,\n\"STAR_ZAV_2\" DECIMAL(5,2),\n\"STAR_POST_2\" INTEGER,\n\"SPOL_ZAV_2\" INTEGER,\n\"NADUMR_ZAV_2\" DECIMAL(5,4),\n\"FLAT_PREM_ZAV_2\" DECIMAL(4,4),\n\"DOBA_FLAT_ZAV_2\" DECIMAL(5,2),\n\"TP_ZDRAVJA_2\" INTEGER,\n\"ID_PERSON_1\" INTEGER,\n\"ID_PERSON_2\" INTEGER,\n\"ZAV_POGOJI\" NVARCHAR(140) \n    ) AS [r];\n\nCREATE EXTERNAL FILE FORMAT [csvFF] WITH (\n    FORMAT_TYPE = DELIMITEDTEXT,\n    DATA_COMPRESSION = 'org.apache.hadoop.io.compress.GzipCodec'\n);\nGO\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "master",
				"poolName": "Built-in"
			}
		},
		"type": "SqlQuery"
	}
}